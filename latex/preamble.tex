% https://habr.com/ru/post/144648/
\documentclass[a4paper,14pt,ukrainian]{extreport}
\usepackage{xltxtra}

\usepackage{extsizes}
%\usepackage{cmap} % для кодировки шрифтов в pdf
\usepackage{fontspec} 
\defaultfontfeatures{Ligatures={TeX}} 
\setmainfont[Ligatures=TeX]{Times New Roman}
\usepackage[ukrainian]{babel}

\usepackage{graphicx} % для вставки картинок
\usepackage{amssymb,amsfonts,amsmath,amsthm} % математические дополнения от АМС
\usepackage{indentfirst} % отделять первую строку раздела абзацным отступом тоже
\usepackage[usenames,dvipsnames]{color} % названия цветов
\usepackage{makecell}
\usepackage{multirow} % улучшенное форматирование таблиц
\usepackage{ulem} % подчеркивания

\usepackage[nodisplayskipstretch]{setspace}
\onehalfspacing % полуторный интервал
\frenchspacing

\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyhf{}
\fancyhead[R]{\thepage}
\fancyheadoffset{0mm}
\fancyfootoffset{0mm}
\setlength{\headheight}{17pt}
\renewcommand{\headrulewidth}{0pt}
\renewcommand{\footrulewidth}{0pt}
\fancypagestyle{plain}{ 
    \fancyhf{}
    \rhead{\thepage}}
\setcounter{page}{1} 

\usepackage[tableposition=top]{caption}
\usepackage{subcaption}
\DeclareCaptionLabelFormat{gostfigure}{Рис. #2}
\DeclareCaptionLabelFormat{gosttable}{Табл. #2}
\DeclareCaptionLabelSeparator{gost}{~---~}
\captionsetup{labelsep=gost}
\captionsetup[figure]{labelformat=gostfigure}
\captionsetup[table]{labelformat=gosttable}
\renewcommand{\thesubfigure}{\asbuk{subfigure}}

\usepackage{titlesec}
 
\titleformat{\chapter}[display]
    {\filcenter}
    {\bfseries\texorpdfstring{\MakeUppercase{\chaptertitlename}}{{\chaptertitlename}} \thechapter}
    {4pt}
    {\bfseries\MakeUppercase}{}
 
\titleformat{\section}
    {\normalsize\bfseries}
    {\thesection}
    {1em}{}
 
\titleformat{\subsection}
    {\normalsize\bfseries}
    {\thesubsection}
    {1em}{}

% Настройка вертикальных и горизонтальных отступов
\titlespacing*{\chapter}{0pt}{-30pt}{8pt}
\titlespacing*{\section}{\parindent}{*4}{*4}
\titlespacing*{\subsection}{\parindent}{*4}{*4}

\usepackage{geometry}
\geometry{left=3cm}
\geometry{right=1.5cm}
\geometry{top=2.4cm}
\geometry{bottom=2.4cm}

\usepackage{enumitem}
\makeatletter
    \AddEnumerateCounter{\asbuk}{\@asbuk}{м)}
\makeatother
\setlist{nolistsep}
%\renewcommand{\labelitemi}{-}
%\renewcommand{\labelenumi}{\asbuk{enumi})}
%\renewcommand{\labelenumii}{\arabic{enumii})}

\usepackage{tocloft}
\renewcommand{\cfttoctitlefont}{\hspace{0.38\textwidth} \bfseries\texorpdfstring{\MakeUppercase}{}}
\renewcommand{\cftbeforetoctitleskip}{-1em}
%\renewcommand{\cftaftertoctitle}{\mbox{}\hfill \\ \mbox{}\hfill{\footnotesize Стр.}\vspace{-2.5em}}
\renewcommand{\cftchapfont}{\normalsize\bfseries \texorpdfstring{\MakeUppercase{\chaptername}}{{\chaptername}} }
\renewcommand{\cftsecfont}{\hspace{31pt}}
\renewcommand{\cftsubsecfont}{\hspace{11pt}}
\renewcommand{\cftbeforechapskip}{1em}
\renewcommand{\cftparskip}{-1mm}
\renewcommand{\cftdotsep}{1}
\renewcommand{\cftchapleader}{\cftdotfill{\cftdotsep}}
\setcounter{tocdepth}{2} % задать глубину оглавления — до subsection включительно

\newcommand{\empline}{\mbox{}\newline}
\newcommand{\likechapterheading}[1]{ 
    \begin{center}
    \textbf{\texorpdfstring{\MakeUppercase{#1}}{{#1}}}
    \end{center}
    \empline}

\makeatletter
    \renewcommand{\@dotsep}{2}
    \newcommand{\l@likechapter}[2]{{\bfseries\@dottedtocline{0}{0pt}{0pt}{#1}{#2}}}
\makeatother
\newcommand{\likechapter}[1]{    
    \likechapterheading{#1}
    \phantomsection    
    \addcontentsline{toc}{likechapter}{\texorpdfstring{\MakeUppercase{#1}}{{#1}}}}

\usepackage[square,numbers,sort&compress]{natbib}
\renewcommand{\bibnumfmt}[1]{#1.\hfill} % нумерация источников в самом списке — через точку
\renewcommand{\bibsection}{\likechapter{Список літератури}} % заголовок специального раздела
\setlength{\bibsep}{0pt}

\usepackage[title,titletoc]{appendix}
 
\titleformat{\paragraph}[display]
    {\filcenter}
    {\texorpdfstring{\MakeUppercase{\chaptertitlename}}{{\chaptertitlename}} \thechapter}
    {8pt}
    {\bfseries}{}
\titlespacing*{\paragraph}{0pt}{-30pt}{8pt}
 
\newcommand{\append}[1]{  
    \clearpage
    \stepcounter{chapter}    
    \paragraph{\texorpdfstring{\MakeUppercase{#1}}{{#1}}}
    \empline
    \addcontentsline{toc}{likechapter}{
        \texorpdfstring{\MakeUppercase{\chaptertitlename~\Asbuk{chapter}\;#1}}{{\chaptertitlename~\Asbuk{chapter}\;#1}}
    }}

\hyphenation{СУБД}
\usepackage[hidelinks]{hyperref}
\usepackage{microtype}